<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Secret sharing | Cryptography lecture notes</title>
  <meta name="description" content="10 Secret sharing | Cryptography lecture notes" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Secret sharing | Cryptography lecture notes" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Secret sharing | Cryptography lecture notes" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="digital-signatures.html"/>
<link rel="next" href="ring-theory.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="part"><span><b>I Introduction to modern cryptography</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Front page</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-security.html"><a href="introduction-to-security.html"><i class="fa fa-check"></i><b>1</b> Introduction to security</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-security.html"><a href="introduction-to-security.html#what-cryptography-is-and-is-not"><i class="fa fa-check"></i><b>1.1</b> What cryptography is and is not</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-security.html"><a href="introduction-to-security.html#fundamental-security-principles"><i class="fa fa-check"></i><b>1.2</b> Fundamental security principles</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-security.html"><a href="introduction-to-security.html#security-parameter"><i class="fa fa-check"></i><b>1.3</b> Security parameter</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-security.html"><a href="introduction-to-security.html#security-level"><i class="fa fa-check"></i><b>1.4</b> Security level</a></li>
</ul></li>
<li class="part"><span><b>II Symmetric cryptography</b></span></li>
<li class="chapter" data-level="2" data-path="randomness-in-cryptography.html"><a href="randomness-in-cryptography.html"><i class="fa fa-check"></i><b>2</b> Randomness in cryptography</a>
<ul>
<li class="chapter" data-level="2.1" data-path="randomness-in-cryptography.html"><a href="randomness-in-cryptography.html#one-time-pad"><i class="fa fa-check"></i><b>2.1</b> One-time pad</a></li>
<li class="chapter" data-level="2.2" data-path="randomness-in-cryptography.html"><a href="randomness-in-cryptography.html#sec:prngs"><i class="fa fa-check"></i><b>2.2</b> Pseudorandom generators</a></li>
<li class="chapter" data-level="2.3" data-path="randomness-in-cryptography.html"><a href="randomness-in-cryptography.html#sec:examples"><i class="fa fa-check"></i><b>2.3</b> Linear feedback shift registers</a></li>
<li class="chapter" data-level="2.4" data-path="randomness-in-cryptography.html"><a href="randomness-in-cryptography.html#true-randomness"><i class="fa fa-check"></i><b>2.4</b> True randomness</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="block-ciphers.html"><a href="block-ciphers.html"><i class="fa fa-check"></i><b>3</b> Block ciphers</a>
<ul>
<li class="chapter" data-level="3.1" data-path="block-ciphers.html"><a href="block-ciphers.html#overview-of-block-ciphers"><i class="fa fa-check"></i><b>3.1</b> Overview of block ciphers</a></li>
<li class="chapter" data-level="3.2" data-path="block-ciphers.html"><a href="block-ciphers.html#modes-of-operation"><i class="fa fa-check"></i><b>3.2</b> Modes of operation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="block-ciphers.html"><a href="block-ciphers.html#electronic-codebook-ecb-mode"><i class="fa fa-check"></i><b>3.2.1</b> Electronic codebook (ECB) mode</a></li>
<li class="chapter" data-level="3.2.2" data-path="block-ciphers.html"><a href="block-ciphers.html#cipher-block-chaining-cbc-mode"><i class="fa fa-check"></i><b>3.2.2</b> Cipher block chaining (CBC) mode</a></li>
<li class="chapter" data-level="3.2.3" data-path="block-ciphers.html"><a href="block-ciphers.html#output-feedback-ofb-mode"><i class="fa fa-check"></i><b>3.2.3</b> Output feedback (OFB) mode</a></li>
<li class="chapter" data-level="3.2.4" data-path="block-ciphers.html"><a href="block-ciphers.html#counter-ctr-mode"><i class="fa fa-check"></i><b>3.2.4</b> Counter (CTR) mode</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="block-ciphers.html"><a href="block-ciphers.html#des-and-aes"><i class="fa fa-check"></i><b>3.3</b> DES and AES</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="block-ciphers.html"><a href="block-ciphers.html#data-encryption-standard-des"><i class="fa fa-check"></i><b>3.3.1</b> Data Encryption Standard (DES)</a></li>
<li class="chapter" data-level="3.3.2" data-path="block-ciphers.html"><a href="block-ciphers.html#advanced-encryption-standard-aes"><i class="fa fa-check"></i><b>3.3.2</b> Advanced Encryption Standard (AES)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hash-functions.html"><a href="hash-functions.html"><i class="fa fa-check"></i><b>4</b> Hash functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hash-functions.html"><a href="hash-functions.html#some-issues-in-cryptocurrencies"><i class="fa fa-check"></i><b>4.1</b> Some issues in cryptocurrencies</a></li>
<li class="chapter" data-level="4.2" data-path="hash-functions.html"><a href="hash-functions.html#sec:hash_def"><i class="fa fa-check"></i><b>4.2</b> Hash functions</a></li>
<li class="chapter" data-level="4.3" data-path="hash-functions.html"><a href="hash-functions.html#birthday-attacks"><i class="fa fa-check"></i><b>4.3</b> Birthday attacks</a></li>
<li class="chapter" data-level="4.4" data-path="hash-functions.html"><a href="hash-functions.html#the-merkle-damgård-transformation"><i class="fa fa-check"></i><b>4.4</b> The Merkle-Damgård transformation</a></li>
</ul></li>
<li class="part"><span><b>III Asymmetric cryptography</b></span></li>
<li class="chapter" data-level="5" data-path="elementary-number-theory.html"><a href="elementary-number-theory.html"><i class="fa fa-check"></i><b>5</b> Elementary number theory</a>
<ul>
<li class="chapter" data-level="5.1" data-path="elementary-number-theory.html"><a href="elementary-number-theory.html#integer-arithmetic"><i class="fa fa-check"></i><b>5.1</b> Integer arithmetic</a></li>
<li class="chapter" data-level="5.2" data-path="elementary-number-theory.html"><a href="elementary-number-theory.html#the-euclidean-algorithm"><i class="fa fa-check"></i><b>5.2</b> The euclidean algorithm</a></li>
<li class="chapter" data-level="5.3" data-path="elementary-number-theory.html"><a href="elementary-number-theory.html#modular-arithmetic"><i class="fa fa-check"></i><b>5.3</b> Modular arithmetic</a></li>
<li class="chapter" data-level="5.4" data-path="elementary-number-theory.html"><a href="elementary-number-theory.html#efficient-modular"><i class="fa fa-check"></i><b>5.4</b> Modular arithmetic, but efficient</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="algebraic-structures.html"><a href="algebraic-structures.html"><i class="fa fa-check"></i><b>6</b> Algebraic structures</a>
<ul>
<li class="chapter" data-level="6.1" data-path="algebraic-structures.html"><a href="algebraic-structures.html#groups"><i class="fa fa-check"></i><b>6.1</b> Groups</a></li>
<li class="chapter" data-level="6.2" data-path="algebraic-structures.html"><a href="algebraic-structures.html#finite-fields"><i class="fa fa-check"></i><b>6.2</b> Finite fields</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="public-key-encryption.html"><a href="public-key-encryption.html"><i class="fa fa-check"></i><b>7</b> Public-key encryption</a>
<ul>
<li class="chapter" data-level="7.1" data-path="public-key-encryption.html"><a href="public-key-encryption.html#public-key-cryptography"><i class="fa fa-check"></i><b>7.1</b> Public-key cryptography</a></li>
<li class="chapter" data-level="7.2" data-path="public-key-encryption.html"><a href="public-key-encryption.html#the-rsa-encryption-scheme"><i class="fa fa-check"></i><b>7.2</b> The RSA encryption scheme</a></li>
<li class="chapter" data-level="7.3" data-path="public-key-encryption.html"><a href="public-key-encryption.html#security-of-rsa"><i class="fa fa-check"></i><b>7.3</b> Security of RSA</a></li>
<li class="chapter" data-level="7.4" data-path="public-key-encryption.html"><a href="public-key-encryption.html#efficiency-optimizations"><i class="fa fa-check"></i><b>7.4</b> Efficiency optimizations</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="discrete-logarithm-cryptosystems.html"><a href="discrete-logarithm-cryptosystems.html"><i class="fa fa-check"></i><b>8</b> Discrete logarithm cryptosystems</a>
<ul>
<li class="chapter" data-level="8.1" data-path="discrete-logarithm-cryptosystems.html"><a href="discrete-logarithm-cryptosystems.html#the-discrete-logarithm-problem"><i class="fa fa-check"></i><b>8.1</b> The discrete logarithm problem</a></li>
<li class="chapter" data-level="8.2" data-path="discrete-logarithm-cryptosystems.html"><a href="discrete-logarithm-cryptosystems.html#the-diffie-hellman-key-exchange"><i class="fa fa-check"></i><b>8.2</b> The Diffie-Hellman key exchange</a></li>
<li class="chapter" data-level="8.3" data-path="discrete-logarithm-cryptosystems.html"><a href="discrete-logarithm-cryptosystems.html#the-elgamal-encryption-scheme"><i class="fa fa-check"></i><b>8.3</b> The ElGamal encryption scheme</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="digital-signatures.html"><a href="digital-signatures.html"><i class="fa fa-check"></i><b>9</b> Digital signatures</a>
<ul>
<li class="chapter" data-level="9.1" data-path="digital-signatures.html"><a href="digital-signatures.html#signature-schemes"><i class="fa fa-check"></i><b>9.1</b> Signature schemes</a></li>
<li class="chapter" data-level="9.2" data-path="digital-signatures.html"><a href="digital-signatures.html#rsa-signatures"><i class="fa fa-check"></i><b>9.2</b> RSA signatures</a></li>
<li class="chapter" data-level="9.3" data-path="digital-signatures.html"><a href="digital-signatures.html#signing-large-messages"><i class="fa fa-check"></i><b>9.3</b> Signing large messages</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="secret-sharing.html"><a href="secret-sharing.html"><i class="fa fa-check"></i><b>10</b> Secret sharing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="secret-sharing.html"><a href="secret-sharing.html#secret-sharing-1"><i class="fa fa-check"></i><b>10.1</b> Secret sharing</a></li>
<li class="chapter" data-level="10.2" data-path="secret-sharing.html"><a href="secret-sharing.html#sec:ssss"><i class="fa fa-check"></i><b>10.2</b> The Shamir secret sharing scheme</a></li>
<li class="chapter" data-level="10.3" data-path="secret-sharing.html"><a href="secret-sharing.html#threshold-decryption-in-the-elgamal-encryption-scheme"><i class="fa fa-check"></i><b>10.3</b> Threshold decryption in the ElGamal encryption scheme</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="ring-theory.html"><a href="ring-theory.html"><i class="fa fa-check"></i><b>A</b> Ring theory</a></li>
<li class="chapter" data-level="B" data-path="primality-testing.html"><a href="primality-testing.html"><i class="fa fa-check"></i><b>B</b> Primality testing</a></li>
<li class="chapter" data-level="C" data-path="polynomial-interpolation.html"><a href="polynomial-interpolation.html"><i class="fa fa-check"></i><b>C</b> Polynomial interpolation</a></li>
<li class="chapter" data-level="D" data-path="refreshers.html"><a href="refreshers.html"><i class="fa fa-check"></i><b>D</b> Refreshers</a>
<ul>
<li class="chapter" data-level="D.1" data-path="refreshers.html"><a href="refreshers.html#set-notation"><i class="fa fa-check"></i><b>D.1</b> Set notation</a></li>
<li class="chapter" data-level="D.2" data-path="refreshers.html"><a href="refreshers.html#probability-theory"><i class="fa fa-check"></i><b>D.2</b> Probability theory</a></li>
<li class="chapter" data-level="D.3" data-path="refreshers.html"><a href="refreshers.html#asymptotic-notation"><i class="fa fa-check"></i><b>D.3</b> Asymptotic notation</a></li>
<li class="chapter" data-level="D.4" data-path="refreshers.html"><a href="refreshers.html#polydiv"><i class="fa fa-check"></i><b>D.4</b> Polynomial division</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cryptography lecture notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="secret-sharing" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Secret sharing</h1>
<p>In this section, we look at yet another cryptographic primitive, with a
different functionality than encryption or signatures. We will learn
about:</p>
<ul>
<li><p>Secret sharing.</p></li>
<li><p>Polynomial interpolation and the Shamir secret sharing scheme.</p></li>
<li><p>Threshold decryption in the ElGamal encryption scheme.</p></li>
</ul>
<div id="secret-sharing-1" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Secret sharing</h2>
<p>Sometimes, we want to ensure that some action requires more than one
party to execute. One dramatic example, often depicted in popular media,
is the two-man concept for the launch of nuclear weapons.<a href="#fn40" class="footnote-ref" id="fnref40"><sup>40</sup></a> The idea
is that, to launch a nuclear missile, two operators must insert their
respective keys in locks that are physically distant. This prevents a
single operator from launching the missiles. The important observation
here is that a single key is useless by itself, yet is it is absolutely
necessary to proceed with the launch. In a sense, each of the keys is
actually <em>part of the key</em> that controls the launch.</p>
<p>In this section, we will look at the cryptographic version of that. Let
us assume that we want to make some information <span class="math inline">\(\mathsf{m}\)</span> difficult
to access unless <span class="math inline">\(n\)</span> different parties collaborate, and let us denote
the parties by the numbers <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>. We call <span class="math inline">\(\mathsf{m}\)</span> the
<em>secret</em>. Each party <span class="math inline">\(i\)</span> will hold some information <span class="math inline">\(s_i\)</span> called a
<em>share</em>. The shares work in a way such that, by themselves, they are
useless. However, if the parties reveal the shares to each other, then
anyone with all the shares will be able to recover the secret.</p>
<p>Moreover, we generalize this definition to admit situations in which not
all shares are necessary to recover the secret. For example, we might
want a situation in which we have <span class="math inline">\(5\)</span> parties, and any <span class="math inline">\(3\)</span> shares are
enough to recover the secret, but any <span class="math inline">\(2\)</span> shares reveal nothing about
the secret. We will call this a <em><span class="math inline">\(3\)</span>-out-of-<span class="math inline">\(5\)</span> secret sharing scheme</em>.
We present a more formal definition below.</p>
<div class="definition">
<p><span id="def:unlabeled-div-92" class="definition"><strong>Definition 10.1  </strong></span><em>Let <span class="math inline">\(t,n\in\mathbb{N}\)</span>. A</em>v<span class="math inline">\(t\)</span>-out-of-<span class="math inline">\(n\)</span> secret
sharing scheme <em>is a pair of algorithms</em>
<span class="math display">\[(\mathsf{Share},\mathsf{Reconstruct}).\]</span></p>
<ul>
<li><p><em>The <span class="math inline">\(\mathsf{Share}\)</span> algorithm takes the secret <span class="math inline">\(\mathsf{m}\)</span> and
produces the set of shares <span class="math inline">\(\{s_1,\dots,s_n\}\)</span>. This algorithm might
be randomized.</em></p></li>
<li><p><em>The <span class="math inline">\(\mathsf{Reconstruct}\)</span> algorithm takes as input a subset of the
shares, and outputs a message. For the scheme to work correctly, we
want that <span class="math inline">\(\mathsf{Reconstruct}\)</span> outputs <span class="math inline">\(\mathsf{m}\)</span> whenever it is
fed with a subset of <span class="math inline">\(\{s_1,\dots,s_n\}\)</span> of size at least <span class="math inline">\(t\)</span>.</em></p></li>
</ul>
</div>
<p>According to this definition, the example at the beginning of the
section would be a <span class="math inline">\(2\)</span>-out-of-<span class="math inline">\(2\)</span> secret sharing scheme. In general,
<span class="math inline">\(t\)</span>-out-of-<span class="math inline">\(n\)</span> secret sharing schemes are called <em>threshold secret
sharing schemes</em>, since we need to reach a <em>threshold</em> <span class="math inline">\(t\)</span> of shares for
the secret to be recoverable. More complex access structures, like
subsets of shares of variable sizes, are possible, but we will not cover
these in the course.</p>
<p>Another aspect of secret sharing that we will not look at, but is worth
mentioning, is the fact that whoever runs the <span class="math inline">\(\mathsf{Share}\)</span> algorithm
knows the secret and all the shares, so this requires, in principle,
that every other party trusts a sole party to generate the shares.</p>
<p>Informally, we will say that a <span class="math inline">\(t\)</span>-out-of-<span class="math inline">\(n\)</span> secret sharing scheme is
secure if any set of less than <span class="math inline">\(t\)</span> shares reveals absolutely no
information about the secret. Consider, for example, the following
candidate for a <span class="math inline">\(2\)</span>-out-of-<span class="math inline">\(2\)</span> secret sharing scheme:</p>
<ul>
<li><p><span class="math inline">\(\mathsf{Share}\)</span>: given <span class="math inline">\(\mathsf{m}\in\{0,1\}^\lambda\)</span>, split
<span class="math inline">\(\mathsf{m}\)</span> in two halves and set each share as one of these
halves.</p></li>
<li><p><span class="math inline">\(\mathsf{Reconstruct}\)</span>: given two shares, concatenate them to
recover the secret.</p></li>
</ul>
<p>It is clear that this will not be secure, because knowing one share
gives away <em>half of the bits</em> of the secret.</p>
<p>A <span class="math inline">\(2\)</span>-out-of-<span class="math inline">\(2\)</span> scheme that does work uses something that we used at
the very beginning of the course: the one-time pad.</p>
<ul>
<li><p><span class="math inline">\(\mathsf{Share}\)</span>: given <span class="math inline">\(\mathsf{m}\in\{0,1\}^\lambda\)</span>, choose a
uniformly random <span class="math inline">\(s_1\in\{0,1\}^\lambda\)</span> and set
<span class="math inline">\(s_2=s_1\oplus\mathsf{m}\)</span>.</p></li>
<li><p><span class="math inline">\(\mathsf{Reconstruct}\)</span>: given two shares <span class="math inline">\(s_1\)</span> and <span class="math inline">\(s_2\)</span>, output
<span class="math inline">\(s_1\oplus s_2\)</span>.</p></li>
</ul>
<p>Clearly, this works because
<span class="math display">\[s_1\oplus s_2 = s_1\oplus(s_1\oplus\mathsf{m})=\mathsf{m},\]</span> since
<span class="math inline">\(s_1\oplus s_1 = 0\)</span>. The security relies on the perfect secrecy of the
one-time pad: given one of the shares without the other, the message
could be anything in <span class="math inline">\(\{0,1\}^\lambda\)</span>.</p>
</div>
<div id="sec:ssss" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> The Shamir secret sharing scheme</h2>
<p>We introduce a <span class="math inline">\(t\)</span>-out-of-<span class="math inline">\(n\)</span> secret sharing scheme due to Shamir, who
you might remember as the S in the RSA cryptosystem.<a href="#fn41" class="footnote-ref" id="fnref41"><sup>41</sup></a> The scheme
relies on the idea of polynomial interpolation, which is explained in
Appendix <a href="polynomial-interpolation.html#polynomial-interpolation">C</a>.</p>
<p>We know that a polynomial of degree <span class="math inline">\(t-1\)</span> is uniquely determined by <span class="math inline">\(t\)</span>
pairs of point and image through the polynomial. Shamir’s idea is to
encode the secret <span class="math inline">\(\mathsf{m}\)</span> into the polynomial, and give one
evaluation to each party, so that any <span class="math inline">\(t\)</span> parties can put together their
shares and recover the polynomial by interpolation. We describe the
scheme more precisely below.</p>
<ul>
<li><p><span class="math inline">\(\mathsf{Share}\)</span>: on input a security parameter <span class="math inline">\(\lambda\)</span>, choose a
prime number <span class="math inline">\(p\)</span> of bitlength <span class="math inline">\(\lambda\)</span>. Choose uniformly random
coefficients <span class="math inline">\(a_1,\dots,a_{t-1}\in\mathbb{Z}_p\)</span>, and define the
following polynomial of degree <span class="math inline">\(t-1\)</span>:
<span class="math display">\[f(X)=\mathsf{m}+\sum_{i=1}^{t-1}a_iX^i.\]</span> For <span class="math inline">\(i=1,\dots,n\)</span>, set
the share corresponding to user <span class="math inline">\(i\)</span> as <span class="math display">\[s_i=(i,f(i)\bmod{p}).\]</span></p></li>
<li><p><span class="math inline">\(\mathsf{Reconstruct}\)</span>: given <span class="math inline">\(t\)</span> different shares, compute the
Lagrange interpolation polynomial <span class="math inline">\(f(X)\)</span> corresponding to them (with
operations modulo <span class="math inline">\(p\)</span>), and output <span class="math inline">\(f(0)\)</span>.</p></li>
</ul>
<p>The scheme works because all the shares come from the same polynomial of
degree <span class="math inline">\(t-1\)</span>, and thus all interpolations from <span class="math inline">\(t\)</span> shares yield the same
polynomial <span class="math inline">\(p(X)\)</span>, which is necessarily the one used to create the
shares in the first place. Given that polynomial, it is clear that
<span class="math inline">\(f(0)=\mathsf{m}\)</span>.</p>
<p>The security comes from the fact that any <span class="math inline">\(t-1\)</span> shares reveal nothing
about the evaluation at <span class="math inline">\(0\)</span>. To see this, assume that we have <span class="math inline">\(t-1\)</span>
shares <span class="math inline">\((x_i,y_i)\)</span>, for <span class="math inline">\(i=1,\dots,t-1\)</span>. Then, for any possible
<span class="math inline">\(\mathsf{m}\)</span>, there is a unique polynomial <span class="math inline">\(f_\mathsf{m}(X)\)</span> of degree
<span class="math inline">\(t-1\)</span> such that
<span class="math display">\[f_\mathsf{m}(0)=\mathsf{m},\qquad \text{and} \qquad f(x_i)=y_i \quad \text{ for all }i=1,\dots,t-1.\]</span>
That is, with only <span class="math inline">\(t-1\)</span> shares, the secret <span class="math inline">\(\mathsf{m}\)</span> could still be
anything!</p>
<div class="proposition">
<p><span id="prp:unlabeled-div-93" class="proposition"><strong>Proposition 10.1  </strong></span><em>The Shamir secret sharing scheme is a secure
threshold secret sharing scheme.</em></p>
</div>
<p>We also note that an explicit formula for the secret <span class="math inline">\(\mathsf{m}=p(0)\)</span>
in terms of the interpolation points can be deduced directly from the
interpolation polynomial formula. Indeed, since
<span class="math display">\[f(X)=\sum_{i=0}^ty_i\ell_i(X),\qquad \text{where} \qquad \ell_i(X)=\prod_{j\neq i}\frac{X-j}{i-j},\]</span>
we have that
<span class="math display">\[\mathsf{m}=f(0)=\sum_{i=0}^ty_i\prod_{j\neq i}\frac{-j}{i-j}.\]</span> Thus,
we actually do not need to interpolate the whole polynomial, as we only
require the evaluation at <span class="math inline">\(0\)</span>.</p>
</div>
<div id="threshold-decryption-in-the-elgamal-encryption-scheme" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Threshold decryption in the ElGamal encryption scheme</h2>
<p>In a normal public-key encryption scheme, the secret key, which is used
for decryption, is stored in a single place. This creates a single point
of failure, as if this place becomes compromised, then the attacker will
be able to decrypt any messages in the past encrypted with the
corresponding public key.</p>
<p>One way to prevent this is to use secret sharing to split the secret
key, and give the shares to different parties. A certain number of
parties will be required to decrypt. This is known as <em>threshold
decryption</em>. The crucial point is that they do not reconstruct the key,
so no single party knows the whole key at any point in the process.
Instead, the decryption is achieved by a combination of <em>partial
decryptions</em>, in which each party uses their share to partially decrypt,
and then these partial decryptions are combined to recover the original
message.</p>
<p>Below, we show how to combine the ElGamal encryption scheme with the
Shamir secret sharing scheme to achieve <span class="math inline">\(t\)</span>-out-of-<span class="math inline">\(n\)</span> threshold
decryption.</p>
<ul>
<li><p><span class="math inline">\(\mathsf{KeyGen}\)</span>: first we run the usual ElGamal key generation. On
input a security parameter <span class="math inline">\(\lambda\)</span>, choose a cyclic group
<span class="math inline">\(\mathbb{G}\)</span> of prime order <span class="math inline">\(p\)</span>, and a generator <span class="math inline">\(g\)</span> of
<span class="math inline">\(\mathbb{G}\)</span>. We will write <span class="math inline">\(\mathbb{G}\)</span> with multiplicative
notation. Sample a uniformly random <span class="math inline">\(x\in\mathbb{Z}_p\)</span>, and set
<span class="math inline">\(h=g^x\)</span>. Set the public key <span class="math display">\[\mathsf{pk}=(\mathbb{G}, g, h),\]</span> and
the secret key <span class="math display">\[\mathsf{sk}=x.\]</span> Then, we use Shamir secret sharing
to split the secret key <span class="math inline">\(\mathsf{sk}\)</span>, producing <span class="math inline">\(n\)</span> shares
<span class="math inline">\(\mathsf{sk}_i=(i,y_i)\)</span>, for <span class="math inline">\(i=1,\dots,n\)</span>. Output
<span class="math inline">\((\mathsf{pk},\mathsf{sk}_1,\dots,\mathsf{sk}_n)\)</span>.</p></li>
<li><p><span class="math inline">\(\mathsf{Enc}\)</span>: given a message <span class="math inline">\(\mathsf{m}\in\mathbb{Z}_p\)</span>, with
<span class="math inline">\(\mathsf{m}\)</span> small, and the receiver’s public key
<span class="math inline">\((\mathbb{G}, g, h)\)</span>, choose a uniformly random <span class="math inline">\(r\in\mathbb{Z}_p\)</span>
and output the ciphertext
<span class="math display">\[\mathsf{c}=(\mathsf{c}_1,\mathsf{c}_2)=(g^r,g^mh^r).\]</span></p></li>
<li><p><span class="math inline">\(\mathsf{Dec}\)</span>: each party <span class="math inline">\(i\)</span>, given a ciphertext
<span class="math inline">\(\mathsf{c}=(\mathsf{c}_1,\mathsf{c}_2)\)</span> and their secret key share
<span class="math inline">\(\mathsf{sk}_i=(i,y_i)\)</span>, computes the <em>partial decryption</em>
<span class="math inline">\(\mathsf{c}_1^{y_i}\)</span>, and sends it to one agreed party that will
take care of reconstructing the message. This designated party, once
<span class="math inline">\(t\)</span> partial decryptions have arrived, computes
<span class="math display">\[\alpha=\prod_{i=1}^t\left(\mathsf{c}_1^{y_i}\right)^{w_i},\qquad \text{where} \qquad w_i=\ell_i(0)=\prod_{j\neq i}\frac{-j}{i-j}.\]</span>
Finally, the message is recovered by computing
<span class="math display">\[\log_g\frac{\mathsf{c}_2}{\alpha}.\]</span></p></li>
</ul>
<p>To see that this works, we just need to ensure that
<span class="math inline">\(\alpha=\mathsf{c}_1^x\)</span> since, if that is the case, then decryption is
just as in the usual ElGamal encryption scheme. Equivalently, we need to
prove that <span class="math display">\[x=\sum_{i=1}^ty_iw_i.\]</span> The expression on the right is
exactly the one given at the end of
Section <a href="secret-sharing.html#sec:ssss" reference-type="ref" reference="sec:ssss">10.2</a>,
which tells us that indeed this formula recovers the secret <span class="math inline">\(x\)</span>.</p>
<p>Note that each party kept their share <span class="math inline">\(y_i\)</span> during the process, never
revealing it. The only information being sent is <span class="math inline">\(\mathsf{c}_1^{y_i}\)</span>,
but we expect <span class="math inline">\(y_i\)</span> to be hard to recover from here, due to the hardness
of the discrete logarithm problem.</p>

</div>
</div>



<div class="footnotes">
<hr />
<ol start="40">
<li id="fn40"><p><a href="https://en.wikipedia.org/wiki/Two-man_rule" class="uri">https://en.wikipedia.org/wiki/Two-man_rule</a><a href="secret-sharing.html#fnref40" class="footnote-back">↩︎</a></p></li>
<li id="fn41"><p>Shamir, A. (1979). How to share a secret. <em>Communications of the
ACM</em>, 22(11), 612-613.<a href="secret-sharing.html#fnref41" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="digital-signatures.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ring-theory.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
